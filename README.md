# IsodatAutoCalibration
This project allows for automated or manual calibration of large numbers of ThermoFisher Scientific Isodat output files.

This project can calibrate either carbonate runs (Carb) or dissolved inorganic carbon (DIC) runs. It assumes the user is competent in manually analyzing and calibrating both carbonate and DIC runs. 

The two sides were developed in parallel by Peter Carlson, 6/2015-12/2017


For Carbonates:

Main files are CarbCal.m, CarbCalibrationSetup.xlsx, and CarbCalTemplate.xlsx

Input files include:

--Isodat Output files (Generated by Isodat)
--Run Log Files (Generated by User)

Output files include:
--[IsodatOutputFileName]Calibrated.xlsx

File Formats:
--Isodat Output files for Carb runs must be formatted with the following headers:
----Row	Identifier 1	Ampl  44	Area 44	d 13C/12C	d 18O/16O
--Runlog Files for Carb runs must be formatted:
----Row	Sample_Name	Notes


CarbCalibrationSetup Notes:
Columns [Default]:
--Do Not Analyze
----[] Any character in this column causes the code to skip column
--Date
----[] Date of sample analysis
--Analyst
----[] 
--ReactionTemp
----[50] Autosampler block temperatre in degrees C
--ReactionTime
----[2] Minimum reaction time in hours
--InputExcelFile
----[] Isodat Output File Name
--RunLogFile
----[] Runlog file name
--Peak
----[Last Two] Picks which Isodat peaks to analyse. Last Two tends to avoid any air peak contamination. Otherwise, input peak number 
----range as [a,b]
--Blank
----False, True, [Auto] Chooses whether to use a blank calibration 
--Linearity
----False, True, [Auto] Chooses whether to use a linearity calibration. This adjusts for changes in standard value with peak area.
--Drift
----False, True, [Auto] Chooses whether to use a drift calibration. This adjusts for changes in standard value as the run progresses.
--NBS18name
----[NBS18] Chooses name for NBS 18 standard. Name all NBS 18 standard samples this name.
--NBS19name
----[NBS19] Chooses name for NBS 19 standard. Name all NBS 19 standard samples this name.
--UTMname
----[UTM] Chooses name for internal lab standard. Name all internal lab standard standard samples this name. If multiple internal lab 
----standards are used, code will need to be adjusted.
--Blankname
----[Blank] Chooses name for Blank. Name blanks this name.
--MaxStDevd18O
----[0.2] Maximum allowable standard deviation between d18O values of sample peaks for individual samples.
--MaxStDevd13C
----[0.2] Maximum allowable standard deviation between d13C values of sample peaks for individual samples.

To run:
Open CarbCalibrationSetup.xlsx
Add rows for sample runs. Fill out all information.
Comment out any unnecessary sample runs by adding a character (% or # or x) to column A.
Make sure Isodat Output File and Runlog File are properly formatted.
Move Isodat Output File and Runlog File to /Carb/
Run CarbCal.m


For DIC:

Main files are DICCal.m, DICCalibrationSetup.xlsx, and DICCalTemplate.xlsx

Input files include:

--Isodat Output files (Generated by Isodat)
--Run Log Files (Generated by User)

Output files include:
--[IsodatOutputFileName]Calibrated.xlsx

File Formats:
--Isodat Output files for DIC runs must be formatted with the following headers:
----Row	Identifier 1	Ampl  44	Area 44	d 13C/12C	d 18O/16O

--Runlog Files for DIC runs must be formatted:
----Row	Sample_Name Volume	Notes
----To the right of these columns, they must also include a table with NaHCO3 standard weights (mg) and volumes (mL):
------Standard	Mass	Volume
------A	
------B	
------C	
------D	
------E	
------F	



DICCalibrationSetup Notes:
Columns [Default]:
--Do Not Analyze
----[] Any character in this column causes the code to skip column
--Date
----[] Date of sample analysis
--Analyst
----[] 
--ReactionTemp
----[40] Autosampler block temperatre in degrees C
--ReactionTime
----[8] Minimum reaction time in hours
--InputExcelFile
----[] Isodat Output File Name
--RunLogFile
----[] Runlog file name
--Peak
----[Last Two] Picks which Isodat peaks to analyse. Last Two tends to avoid any air peak contamination. Otherwise, input peak number 
----range as [a,b]
--Blank
----False, True, [Auto] Chooses whether to use a blank calibration 
--Drift
----False, True, [Auto] Chooses whether to use a drift calibration. This adjusts for changes in standard value as the run progresses.
--Linearity
----False, True, [Auto] Chooses whether to use a linearity calibration. This adjusts for changes in standard value with peak area.
--Blankname
----[Blank] Chooses name for Blank. Name blanks this name.
--Aname
----[A] Chooses name for internal lab NaHCO3 standard A. Name all A standard samples this name.
--Bname
----[B] Chooses name for internal lab NaHCO3 standard B. Name all B standard samples this name.
--Cname
----[C] Chooses name for internal lab NaHCO3 standard C. Name all C  standard standard samples this name.
--Dname
----[D] Chooses name for internal lab NaHCO3 standard D. Name all D  standard standard samples this name.
--Ename
----[E] Chooses name for internal lab NaHCO3 standard E. Name all E  standard standard samples this name.
--Fname
----[F] Chooses name for internal lab NaHCO3 standard F. Name all F standard standard samples this name.
--MaxStDevd18O
----[100] Maximum allowable standard deviation between d18O values of sample peaks for individual samples.
--MaxStDevd13C
----[0.2] Maximum allowable standard deviation between d13C values of sample peaks for individual samples.

To run:
Open DICCalibrationSetup.xlsx
Add rows for sample runs. Fill out all information.
Comment out any unnecessary sample runs by adding a character (% or # or x) to column A.
Make sure Isodat Output File and Runlog File are properly formatted.
Move Isodat Output File and Runlog File to /DIC/
Run DICCal.m






